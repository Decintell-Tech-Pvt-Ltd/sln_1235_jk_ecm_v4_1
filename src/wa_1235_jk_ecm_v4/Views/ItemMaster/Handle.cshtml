@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor
@model wa_1235_jk_ecm_v4.Models.ItemMaster
@{
    ViewData["Title"] = "Handle";
    Layout = "~/Views/Shared/_ECMMaster.cshtml";
}
<div class="content-wrapper">
    <!-- InstanceBeginEditable name="EditRegion1" -->
    <div class="modal fade" id="selectchart">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Chart</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <table width="100%" class="table table-bordered example1" id="TableHandleChart">
                        <thead>
                            <tr>
                                <th style="width:10%; text-align: center;">Select Chart</th>
                                <th style="width:30%; text-align: Left;">Chart</th>                                
                                @* <th width="111">View Chart</th> *@

                            </tr>
                        </thead>
                        <tbody id="TableHandleChartBody">
                        </tbody>


                    </table>

                </div>
            </div>

        </div>
    </div>


    <div class="modal fade" id="color">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Pantone Shade Color's</h5>


                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>

                </div>
                <div class="modal-body">Color Card here </div>
                <div class="modal-body">
                    <iframe id="pdfViewer" src="https://decintellai.com/ui/all-Modules/UI_Repository/pdf/PantoneColors.pdf" style="width: 100%; height: 500px;"></iframe>
                </div>












            </div>

        </div>
    </div>

    <div class="modal fade" id="view">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">View</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div class="modal-body">
                    <input type="hidden" id="txtID" value="68">
                    <b>Request No.:</b><span id="ApprovedRequestNo">@Context.Request.Query["ReqValue"]</span> ,&nbsp;&nbsp;
                    <b>Brand:</b><span id="ApprovedHandleType"></span>,&nbsp;&nbsp;
                    <b>Chart No.:</b><span id="ApprovedHandleChartNo"></span>

                    <div>
                        <div align="center" class="mt-2">
                            @* <img id="displayImage" style="height:550px;" class="img-fluid" src="https://decintellai.com/ui/all-Modules/UI_Repository/dist/img/Handle.jpg"> *@
                            <img id="displayImage" style="height:550px;" class="img-fluid" />
                        </div>
                    </div>
                </div>













            </div>

        </div>
    </div>







    <section class="content-header">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-4">
                    <h5>New SKU</h5>
                </div>
                <div class="col-lg-8">
                    <ol class="breadcrumb float-sm-right">
                        <li class="breadcrumb-item"><a href="#" onclick="UserDetailChange('Index')">Home</a></li>
                        <li class="breadcrumb-item"><a href="@Url.Action("Index", "Home")">ECM</a></li>
                        <li class="breadcrumb-item active"><a href="@Url.Action("ItemMasterIndex", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString() })">Item Master</a></li>
                        <li class="breadcrumb-item active">SKU</li>
                    </ol>
                </div>

            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="btnwidth50 float-right ">
                        <a id="btnBack" class="btn btn-block bg-gradient-danger btn-xs float-left"
                           onClick="history.back()"  title="Go back to the previous page">
                            Back
                        </a>
                    </div>

                </div>
            </div>

        </div><!-- /.container-fluid -->
    </section>

    <section class="content">
        <div class="content">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card card-primary card-tabs p-a-2" style="height: 100%;">
                            <div class="card-header p-0 pt-1">
                                
                                    @{
                                        string cssClass = ""; // Define the default CSS class variable

                                        if (Context.Request.Query["Display"].ToString() == "View")
                                        {
                                            cssClass = "disabledbutton"; // Reset cssClass if the condition is met
                                        }
                                    }
                                    <ul class="nav nav-tabs" id="custom-tabs-one-tab" role="tablist">
                                        @if (Context.Request.Query["Display"].ToString() == "View")
                                        {
                                        <li class="nav-item"> <a class="nav-link" href="@Url.Action("Changenoteproductiondetails", "ChangeNotes", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Display = "View", Status = "SKU" })">Production Details</a> </li>
                                            <li class="nav-item"> <a class="nav-link active" href="@Url.Action("Changenotedispatchdetails", "ChangeNotes", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Display = "View", Status = "SKU"  })">Dispatch Details</a> </li>
                                        }
                                    @if (Context.Request.Query["Display"].ToString() == "Approval")
                                        {
                                        <li class="nav-item"> <a href="@Url.Action("Productiondetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Mode = "Edit", Display = "Approval", Status = "SKU" })" class="nav-link "> Production Details </a> </li>
                                        <li class="nav-item"> <a href="@Url.Action("Dispatchdetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Mode = "Edit", Display = "Approval", Status = "SKU" })" class="nav-link active"> Dispatch Details </a> </li>
                                        }
                                    else if (Context.Request.Query["Mode"].ToString() != null && Context.Request.Query["Mode"].ToString() != "" && Context.Request.Query["Status"].ToString() == "SKU")
                                    {
                                        <li class="nav-item"> <a href="@Url.Action("Productiondetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Mode = "Edit", Status = "SKU" })" class="nav-link "> Production Details </a> </li>
                                        <li class="nav-item"> <a href="@Url.Action("Dispatchdetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Mode = "Edit", Status = "SKU" })" class="nav-link active"> Dispatch Details </a> </li>
                                    }
                                    else if (Context.Request.Query["Mode"].ToString() != null && Context.Request.Query["Mode"].ToString() != "" && Context.Request.Query["Status"].ToString() == "SET")
                                    {
                                        <li class="nav-item"> <a href="@Url.Action("Newsetproductiondetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Mode = "Edit", Status = "SET" })" class="nav-link "> Production Details </a> </li>
                                        <li class="nav-item"> <a href="@Url.Action("PackingMaterialDetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Mode = "Edit", Status = "SET" })" class="nav-link active"> Dispatch Details </a> </li>
                                    }
                                        else
                                        {
                                        <li class="nav-item"> <a class="nav-link" href="@Url.Action("Productiondetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), Status = "SKU" })">Production Details</a> </li>
                                            <li class="nav-item"> <a class="nav-link active" href="@Url.Action("Dispatchdetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString() , Status = "SKU" })">Dispatch Details</a> </li>
                                        }
                                </ul>
                            </div>
                            <div style="clear:both;"></div>

                            <div class="card-body">
                                <div class="row">
                                    <div class="mb-2 col-lg-9">
                                        <b>Customer:</b>&nbsp;@(Model.ProductionDetails_List?.CustomerName ?? "") &nbsp;
                                        <b>Brand:</b>&nbsp;@(Model.ProductionDetails_List?.BrandName ?? "")
                                    </div>
                                </div>


                                <div class="card-header p-2">
                                    <ul class="nav nav-pills" id="custom-tabs-one-tab" role="tablist">

                                        @{
                                            if (Context.Request.Query["Display"].ToString() == "Approval")
                                            {
                                                <li class="nav-item"> <a class="nav-link" href="@Url.Action("Dispatchdetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Mode = "Edit", Display = "Approval", Status = Context.Request.Query["Status"].ToString() })">Stamp</a> </li>
                                                <li class="nav-item"> <a class="nav-link active" href="@Url.Action("Handle", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Mode = "Edit", Display = "Approval" , Status = Context.Request.Query["Status"].ToString()})">Handle</a> </li>
                                                <li class="nav-item"> <a class="nav-link" href="@Url.Action("PackingMaterialDetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Mode = "Edit", Display = "Approval", Status = Context.Request.Query["Status"].ToString() })">Packing Material Details</a> </li>
                                                <li class="nav-item"> <a class="nav-link" href="@Url.Action("Labeldetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Mode = "Edit", Display = "Approval" , Status = Context.Request.Query["Status"].ToString()})">Label Details</a> </li>
                                                <li class="nav-item"> <a class="nav-link" href="@Url.Action("Otherpackingdetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Mode = "Edit", Display = "Approval", Status = Context.Request.Query["Status"].ToString() })">Other Packing Details</a> </li>
                                                <li class="nav-item"> <a class="nav-link" href="@Url.Action("ShowLabelLayout", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Mode = "Edit", Display = "Approval", Status = Context.Request.Query["Status"].ToString() })">View Label Layout</a> </li>
                                            }
                                            else if (Context.Request.Query["Mode"].ToString() != null && Context.Request.Query["Mode"].ToString() != "")
                                            {
                                                <li class="nav-item"> <a class="nav-link" href="@Url.Action("Dispatchdetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Mode = "Edit", Status = Context.Request.Query["Status"].ToString() })">Stamp</a> </li>
                                                <li class="nav-item"> <a class="nav-link active" href="@Url.Action("Handle", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Mode = "Edit" , Status = Context.Request.Query["Status"].ToString()})">Handle</a> </li>
                                                <li class="nav-item"> <a class="nav-link" href="@Url.Action("PackingMaterialDetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Mode = "Edit", Status = Context.Request.Query["Status"].ToString() })">Packing Material Details</a> </li>
                                                <li class="nav-item"> <a class="nav-link" href="@Url.Action("Labeldetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Mode = "Edit", Status = Context.Request.Query["Status"].ToString() })">Label Details</a> </li>
                                                <li class="nav-item"> <a class="nav-link" href="@Url.Action("Otherpackingdetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Mode = "Edit", Status = Context.Request.Query["Status"].ToString() })">Other Packing Details</a> </li>
                                                <li class="nav-item"> <a class="nav-link" href="@Url.Action("ShowLabelLayout", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Mode = "Edit", Status = Context.Request.Query["Status"].ToString() })">View Label Layout</a> </li>
                                            }
                                            else
                                            {
                                                <li class="nav-item"> <a class="nav-link" href="@Url.Action("Dispatchdetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Status = Context.Request.Query["Status"].ToString() })">Stamp</a> </li>
                                                <li class="nav-item"> <a class="nav-link active" href="@Url.Action("Handle", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Status = Context.Request.Query["Status"].ToString() })">Handle</a> </li>
                                                <li class="nav-item"> <a class="nav-link" href="@Url.Action("PackingMaterialDetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Status = Context.Request.Query["Status"].ToString() })">Packing Material Details</a> </li>
                                                <li class="nav-item"> <a class="nav-link" href="@Url.Action("Labeldetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Status = Context.Request.Query["Status"].ToString() })">Label Details</a> </li>
                                                <li class="nav-item"> <a class="nav-link" href="@Url.Action("Otherpackingdetails", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Status = Context.Request.Query["Status"].ToString() })">Other Packing Details</a> </li>
                                                <li class="nav-item"> <a class="nav-link" href="@Url.Action("ShowLabelLayout", "ItemMaster", new { PageID = Context.Request.Query["PageID"].ToString(), ParentID = Context.Request.Query["ParentID"].ToString(), ModuleID = Context.Request.Query["ModuleID"].ToString(), ModulePageID = Context.Request.Query["ModulePageID"].ToString(), ReqValue = Context.Request.Query["ReqValue"].ToString(), Status = Context.Request.Query["Status"].ToString() })">View Label Layout</a> </li>
                                            }
                                        }

                                    </ul>
                                </div>

                                <br />
                                <div class="col-md-12">
                                    <div class="row">

                                        <div class="form-group col-md-3">
                                            <label>Handle Presence </label>
                                            <select class="form-control select2 select2-hidden-accessible" style="width: 100%;" tabindex="-1" aria-hidden="true" id="dllHandlePresence" onchange="OnChangeHandlePresence();">
                                                <option value="0">Select</option>
                                                @foreach (var item in Model.HandlePresencelist)
                                                {
                                                    @if (Model.HandleMasterForEditDetails != null && item.LookupId == Model.HandleMasterForEditDetails.HandlePresenceId)
                                                    {
                                                        <option selected="selected" value="@item.LookupId">@item.LookupValue</option>
                                                    }
                                                    else
                                                    {
                                                        <option value="@item.LookupId">@item.LookupValue</option>
                                                    }
                                                }
                                            </select>
                                        </div>



                                        <div class="form-group col-md-3">
                                            <label>Handle Type</label>
                                            <select class="form-control select2 select2-hidden-accessible" style="width: 100%;" tabindex="-1" aria-hidden="true" id="dllHandleType" onchange="chartData();">
                                                <option value="0">Select</option>
                                                @foreach (var item in Model.HandleTypeList)
                                                {
                                                    @if (Model.HandleMasterForEditDetails != null && item.HandleType == Model.HandleMasterForEditDetails.HandleType)
                                                    {
                                                        <option selected="selected" value="@item.Id">@item.HandleType</option>
                                                    }
                                                    else
                                                    {
                                                        <option value="@item.Id">@item.HandleType</option>
                                                    }
                                                }
                                            </select>
                                        </div>

                                        <div class="form-group col-md-2">
                                            <label>Handle Chart No.</label>                                           
                                            @Html.TextBoxFor(m => m.HandleMasterForEditDetails.HandleChartNo, new { @class = "form-control", id = "txtHandleChartNo", disabled = "disabled" })
                                            
                                        </div>

                                        <div style="margin-top:35px;">
                                            <button type="button"
                                                    class="btn btn-primary btn-xs btnwidth50" id="ViewHandle_btn"
                                                    data-toggle="modal" data-target="#selectchart"
                                                    title="View details">
                                                View
                                            </button>

                                        </div>
                                        <div class="form-group col-md-2">
                                            <label>Handle Color</label>
                                            @* @Html.TextAreaFor(m => m.HandleMasterForEditDetails.HandleColor, new { @class = "form-control", id = "txtHandleColor" }) *@
                                            @Html.TextBoxFor(m => m.HandleMasterForEditDetails.HandleColor, new { @class = "form-control", id = "txtHandleColor" })

                                        </div>

                                        <div style="margin-top:35px;">
                                            <button type="button"
                                                    class="btn btn-primary btn-xs btnwidth50" id="ViewHandle_btn"
                                                    data-toggle="modal" onclick="showColorPdfModal()l" data-target="#color"
                                                    title="View details">
                                                View
                                            </button>

                                        </div>

                                        <div class="form-group col-md-2">
                                            <label>Insert Color</label>
                                            @Html.TextBoxFor(m => m.HandleMasterForEditDetails.InsertColor, new { @class = "form-control", id = "txtInsertColor" })
                                        </div>

                                        <div style="margin-top:35px;">
                                            <button type="button"
                                                    class="btn btn-primary btn-xs btnwidth50" id="ViewHandle_btn"
                                                    data-toggle="modal" onclick="showColorPdfModal()l" data-target="#color"
                                                    title="View details">
                                                View
                                            </button>

                                        </div>

                                        <div class="form-group col-md-2">
                                            <label>Insert Chart No.</label>
                                            @Html.TextBoxFor(m => m.HandleMasterForEditDetails.InsertChartNo, new { @class = "form-control", id = "txtInsertChartNo" })
                                        </div>


                                        <div style="margin-top:35px;">
                                            <button type="button" id="ViewHandle_btn"
                                                    class="btn btn-primary btn-xs btnwidth50"
                                                    data-toggle="modal" data-target="#selectchart"
                                                    title="View details">
                                                View
                                            </button>

                                        </div>




                                    </div>


                                    <div class="btnwidth50 float-right">
                                        <button type="button"
                                                class="btn btn-primary btn-xs btnwidth50"
                                                onclick="AddHandleObjData();" id="btnHandleSave"
                                                title="Save the current record">
                                            Save
                                        </button>


                                    </div>


                                </div>




                                <!-- /.card -->
                            </div>



                        </div>
                        <!-- /.col-md-6 -->
                        <!-- /.row -->
                    </div><!-- /.container-fluid -->
                </div>
            </div>
        </div>
    </section>
</div>



<script>
    
    function OnChangeHandlePresence(){

        var HandlePresence  =  $("#dllHandlePresence option:selected").text();
        if(HandlePresence=="Without handle")
        {
            $("#dllHandleType").prop("disabled", true);
            $("#txtHandleChartNo").prop("disabled", true);
            $("#txtInsertChartNo").prop("disabled", true);
            $("#txtHandleColor").prop("disabled", true);
            $("#txtInsertColor").prop("disabled", true);
        }
        else
        {
            $("#dllHandleType").prop("disabled", false);
            $("#txtHandleChartNo").prop("disabled", false);
            $("#txtInsertChartNo").prop("disabled", false);
            $("#txtHandleColor").prop("disabled", false);
            $("#txtInsertColor").prop("disabled", false);
        }

    }

    // function chartData() {
    //     var HandleType = $("#dllHandleType option:selected").text();

    //     let JsonData = { HandleTypeId: HandleType }
    //     var JSONInsert = JSON.stringify(JsonData);

    //     $.ajax({
    //         type: 'POST',
    //         url: '@Url.Action("GetHandleChartData", "ItemMaster")',
    //         data: { JsonData: JSONInsert },
    //         datatype: 'json',
    //         success: function (data) {
    //             var Chartdata = data.handleTypeList;
    //             var tbody = $('#TableHandleChart');
    //             tbody.empty();

    //             $.each(Chartdata, function (index, item) {
    //                 var row = '<tr>' +
    //                     '<td><center><input name="chartRadio" type="radio" value="' + item.handleChartNo + '" /></center></td>' +
    //                     '<td>' + item.handleChartNo + '</td>' +
    //                     '<td style="text-align: center;"><a href="#" data-toggle="modal" data-target="#view" onclick="OpenDocument(\'' + item.handleChartNo + '.jpg\')" class="fa-i-big cyanbt"><img src="../decintell/icons/view.png" class="img-responsive" style="max-width: 100%; height: auto;"></a></td>' +
    //                     '</tr>';
    //                 tbody.append(row);
    //             });

    //             //selectInsert

    //             var tbody = $('#selectInsert');
    //             tbody.empty();

    //             $.each(Chartdata, function (index, item) {
    //                 var row = '<tr>' +
    //                     '<td><center><input name="chartRadio" type="radio" value="' + item.handleChartNo + '" /></center></td>' +
    //                     '<td>' + item.insertChart + '</td>' +
    //                     '<td style="text-align: center;"><a href="#" class="fa-i-big cyanbt"><img src="../decintell/icons/view.png" class="img-responsive" style="max-width: 100%; height: auto;"></a></td>'
    //                     +
    //                     '</tr>';
    //                 tbody.append(row);
    //             });




    //         },
    //         error: function () {
    //             alert('Error occurred while processing your request.');
    //         }
    //     });


    // }
         function chartData() {
        var HandleType = $("#dllHandleType option:selected").text();
        let JsonData = { HandleTypeId: HandleType };
        var JSONInsert = JSON.stringify(JsonData);

        $.ajax({
            type: 'POST',
            url: '@Url.Action("GetHandleChartData", "ItemMaster")',
            data: { JsonData: JSONInsert },
            dataType: 'json', // FIXED: was 'datatype'
            success: function (data) {
                var Chartdata = data.handleTypeList;

                // Destroy DataTable if already exists
                if ($.fn.DataTable.isDataTable('#TableHandleChart')) {
                    $('#TableHandleChart').DataTable().clear().destroy();
                }

                // Clear tbody content
                var tbody1 = $('#TableHandleChartBody');
                tbody1.empty();

                $.each(Chartdata, function (index, item) {
                    var radioId = 'handleRadio_' + index;
                    var row = '<tr>' +
                        '<td>' +
                            '<div class="custom-control custom-radio" align="center">' +
                                '<input type="radio" class="custom-control-input" id="' + radioId + '" name="chartRadio" value="' + item.handleChartNo + '">' +
                                '<label class="custom-control-label" for="' + radioId + '"></label>' +
                            '</div>' +
                        '</td>' +
                        '<td style="text-align: left;">' +
                            '<a href="#" data-toggle="modal" data-target="#view" onclick="OpenDocument(\'' + item.handleChart + '\', \'' + item.handleType + '\', \'' + item.handleChartNo + '\')">' + item.handleChartNo + '</a>' +
                        '</td>' +
                    '</tr>';
                    tbody1.append(row);
                });

                // Re-initialize DataTable with pagination
                $('#TableHandleChart').DataTable({
                    paging: true,
                    searching: true,
                    ordering: false,
                    info: false,
                    pageLength: 5
                });
            },
            error: function () {
                alert('Error occurred while processing your request.');
            }
        });
    }


           function showColorPdfModal() {
        const pdfUrl = "../Handle/PantoneColors.pdf";
        $("#pdfViewer").attr('src', pdfUrl);
        $("#color").modal("show");
    }

    // $("#colorId").click(function () {
    //     // Make AJAX request to fetch PDF content
    //     var pdfUrl = "../Handle/PantoneColors.pdf";

    //     window.open(pdfUrl, "_blank");

    // });

    function AddHandleObjData() {

        var selectedData = {};

        var mode = '@Context.Request.Query["Mode"]';

        var iOperationalFlag = 1;

        if (mode != '' && mode != 'undefined' && mode == 'Edit')
            iOperationalFlag = 2;
        else
            iOperationalFlag = 1;


        var HandlePresenceId = $("#dllHandlePresence").val();
        var HandleTypeId = $("#dllHandleType").val();
        var HandleChartNo;
        var InsertChartNo;
         var HandleColor ;
          var InsertColor;

           var HandlePresence  =  $("#dllHandlePresence option:selected").text();

        if (iOperationalFlag == 1)
        {

            if(HandlePresence=="Without handle")
            {
                HandleChartNo = '';
                InsertChartNo = '';
            }
            else
            {
                HandleChartNo = document.querySelector('input[name="chartRadio"]:checked').value;
                InsertChartNo = document.querySelector('input[name="chartRadio"]:checked').value;
                HandleColor  = $("#txtHandleColor").val();
                InsertColor  = $("#txtInsertColor").val();
            }
        }
        else
        {

            if(HandlePresence=="Without handle")
            {
                HandleChartNo = '';
                InsertChartNo = '';
            }
            else
            {
                HandleChartNo = $("#txtHandleChartNo").val();
                InsertChartNo = $("#txtInsertChartNo").val();
                HandleColor  = $("#txtHandleColor").val();
                InsertColor  = $("#txtInsertColor").val();
            }
        }



       // var Remark = $("#txtRemark").val();



        var HandlePresenceId = parseInt(HandlePresenceId);
        var HandleTypeId = parseInt(HandleTypeId);
        var HandleChartNo = HandleChartNo;
        var InsertChartNo = InsertChartNo;
        var HandleColor = HandleColor;
        var InsertColor = InsertColor;
       // var Remark = Remark;

        var Reqno = '@ViewBag.NewReqNo'




        var json = {
            Reqno: Reqno,
            HandlePresenceId: HandlePresenceId,
            HandleTypeId: HandleTypeId,
            HandleChartNo: HandleChartNo,
            InsertChartNo: InsertChartNo,
            HandleColor: HandleColor,
            InsertColor: InsertColor,
            iOperationalFlag: iOperationalFlag
            // ,
            // Remark: Remark
        };

        var JSONInsert = JSON.stringify(json);
        $.ajax({
            type: 'POST',
            url: '@Url.Action("SaveHandleDetails", "ItemMaster")',
            data: { JsonData: JSONInsert },
            datatype: 'json',
            success: function (data) {
                var Insertdata = data.response;
                var parts = Insertdata.split(' '); // Split the string into parts based on spaces
                var message = parts.slice(0, -1).join(' ');
                //alert(message);
                alert("Handle details saved successfully");
                var intValue = Insertdata.match(/\d+/)[0];

                var pageID = encodeURIComponent('@Context.Request.Query["PageID"]');
                var parentID = encodeURIComponent('@Context.Request.Query["ParentID"]');
                var moduleID = encodeURIComponent('@Context.Request.Query["ModuleID"]');
                var modulePageID = encodeURIComponent('@Context.Request.Query["ModulePageID"]');
                var Status = encodeURIComponent('@Context.Request.Query["Status"]');
                var Display = '@Context.Request.Query["Display"]';
                var redirectUrl;

                if (Display == 'Approval') {
                       redirectUrl = '@Url.Action("PackingMaterialDetails", "ItemMaster")' +
                        '?PageID=' + pageID +
                        '&ParentID=' + parentID +
                        '&ModuleID=' + moduleID +
                        '&ModulePageID=' + modulePageID +
                        '&ReqValue=' + intValue +
                        '&Mode=Edit'+
                        '&Display=Approval&Status=' + Status;
                }
                else if (mode == 'Edit') {
                    redirectUrl = '@Url.Action("PackingMaterialDetails", "ItemMaster")' +
                        '?PageID=' + pageID +
                        '&ParentID=' + parentID +
                        '&ModuleID=' + moduleID +
                        '&ModulePageID=' + modulePageID +
                        '&ReqValue=' + intValue +
                        '&Mode=Edit&Status=' + Status;
                }
                else {
                    redirectUrl = '@Url.Action("PackingMaterialDetails", "ItemMaster")' +
                        '?PageID=' + pageID +
                        '&ParentID=' + parentID +
                        '&ModuleID=' + moduleID +
                        '&ModulePageID=' + modulePageID +
                        '&ReqValue=' + intValue+
                        '&Mode=Edit&Status=' + Status;
                }
                window.location.href = redirectUrl;
            },
            error: function () {
                alert('Error occurred while processing your request.');
            }
        });
    }

    // async function OpenDocument(FileName) {
    //     var JwToken = '@ViewBag.JWTToken';
    //     var url1 = '@ViewBag.ApiUrl';
    //     const apiUrl = url1 + 'UploadAndDownLoadFile/DownloadAsync';
    //     // G: \static\falco_co_in\1235_jk\ecm_v3\others\stamps\ag\ca\34
    //     var Folder = 'others\\handle_inserts' + '\\';
    //     var path = Folder;

    //     const request = {
    //         FileName: path + FileName
    //     };

    //     try {
    //         const response = await fetch(apiUrl, {
    //             method: "POST",
    //             headers: {
    //                 "Content-Type": "application/json",
    //                 Authorization: 'Bearer ' + JwToken
    //             },
    //             body: JSON.stringify(request),
    //         });

    //         if (!response.ok) {
    //             console.error("Network response was not ok");
    //             return;
    //         }

    //         // Open the downloaded file in a new tab.
    //         const blob = await response.blob();
    //         const objectURL = URL.createObjectURL(blob);
    //         // Display the image in the img tag
    //         const imgElement = document.getElementById('displayImage');
    //         imgElement.src = objectURL;


    //     } catch (error) {
    //         console.error("Error:", error);
    //     }
    // }

    async function OpenDocument(FileName,HandleType,ChartNo) {
         var JwToken = '@ViewBag.JWTToken';
      var blobStorageUrl = '@ViewBag.ApiUrl';
      let blobPathPrefix = '@ViewBag.BaseBlobPath';
        // G: \static\falco_co_in\1235_jk\ecm_v3\others\stamps\ag\ca\34
        var path = 'others\\handle_inserts' + '\\';
       // var path = Folder;

        // const request = {
        //     FileName: path + FileName
        // };

        // try {
        //     const response = await fetch(apiUrl, {
        //         method: "POST",
        //         headers: {
        //             "Content-Type": "application/json",
        //             Authorization: 'Bearer ' + JwToken
        //         },
        //         body: JSON.stringify(request),
        //     });

        //     if (!response.ok) {
        //         console.error("Network response was not ok");
        //         const imgElement = document.getElementById('displayImage');
        //          imgElement.src = "";
        //         return;
        //     }

        //     // Open the downloaded file in a new tab.
        //     const blob = await response.blob();
        //     const objectURL = URL.createObjectURL(blob);
        //     // Display the image in the img tag
        //     const imgElement = document.getElementById('displayImage');
        //     imgElement.src = objectURL;
        //     $('#ApprovedHandleChartNo').text(ChartNo ?? '');
        //     $('#ApprovedHandleType').text(HandleType ?? '');

        // } catch (error) {
        //     console.error("Error:", error);
        // }
         const blobpath = (normalizePathPrefix(blobPathPrefix) + normalizePathPrefix(path) ).toLowerCase()+ FileName;

            const JSONData = {
                blobPath: blobpath,
                asSas: false,
                downloadFileName: FileName
            };

            try {
                $('#loader').show();

                const response = await $.ajax({
                    url: blobStorageUrl + 'Files/get',
                    headers: { Authorization: 'Bearer ' + JwToken },
                    type: "POST",
                    contentType: "application/json",
                    data: JSON.stringify(JSONData),
                    xhrFields: { responseType: 'blob' }
                });

                if (response && response.size > 0) {
                    const objectURL = URL.createObjectURL(response);
                    // Display the image in the img tag
                    const imgElement = document.getElementById('displayImage');
                    imgElement.src = objectURL;

                }
                 $('#ApprovedHandleChartNo').text(ChartNo ?? '');
                 $('#ApprovedHandleType').text(HandleType ?? '');
            }
                catch (error) {
                    console.error("Error:", error);
                      const imgElement = document.getElementById('displayImage');
                    imgElement.src = '';
                    $('#ApprovedHandleChartNo').text(ChartNo ?? '');
                     $('#ApprovedHandleType').text(HandleType ?? '');
                }
                finally {
             $('#loader').hide();
            }
    }
    
    $(document).ready(function () {
        // Event handler for change event on radio buttons
        $(document).on('change', 'input[name="chartRadio"]', function () {
            // Get the value of the selected radio button
            var selectedValue = $(this).val();

            // Set the value of the textbox
            $('#txtHandleChartNo').val(selectedValue);
              $('#txtInsertChartNo').val(selectedValue);
        });

        
    });
        $(document).ready(function () {
        // Trigger this on change
        // $('#dllHandlePresence').on('change', function () {
        //     var selectedValue = $(this).val();
        //     var selectedText = $("#dllHandlePresence option:selected").text();

        //     // Set it to some other field if needed
        //     $('#dllHandlePresence').val(selectedText).trigger('change');
        // });

        // Also trigger change manually on page load if a value is already selected
        if ($('#dllHandlePresence').val() !== "0") {
            $('#dllHandlePresence').trigger('change');
        }
    });

</script>